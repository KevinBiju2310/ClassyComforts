<%- include("../layouts/userHeader") %>
    <style>

    </style>
    <main class="main">
        <section class="home-slider position-relative pt-50">
            <div class="hero-slider-1 dot-style-1 dot-style-1-position-1">
                <div class="single-hero-slider single-animation-wrap">
                    <div class="container">
                        <div class="row align-items-center slider-animated-1">
                            <div class="col-lg-12 col-md-6">
                                <div class="single-slider-img single-slider-img-1">
                                    <img class="animated slider-1-1" src="/assets/imgs/slider/slider1.jpg"
                                        style="width: 100%; object-fit: cover;" alt="">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="single-hero-slider single-animation-wrap">
                    <div class="container">
                        <div class="row align-items-center slider-animated-1">
                            <div class="col-lg-12 col-md-6">
                                <div class="single-slider-img single-slider-img-1">
                                    <img class="animated slider-1-1" src="/assets/imgs/slider/slider2.jpeg"
                                        style="width: 100%; object-fit:cover;" alt="">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="single-hero-slider single-animation-wrap">
                    <div class="container">
                        <div class="row align-items-center slider-animated-1">
                            <div class="col-lg-12 col-md-6">
                                <div class="single-slider-img single-slider-img-1">
                                    <img class="animated slider-1-1" src="/assets/imgs/slider/slider3.jpeg"
                                        style="width: 100%;object-fit: cover;" alt="">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="slider-arrow hero-slider-1-arrow"></div>
        </section>
        <section class="featured section-padding position-relative">
            <div class="container">
                <div class="row">
                    <div class="col-lg-2 col-md-4 mb-md-3 mb-lg-0">
                        <div class="banner-features wow fadeIn animated hover-up">
                            <img src="/assets/imgs/theme/icons/feature-1.png" alt="">
                            <h4 class="bg-1">Free Shipping</h4>
                        </div>
                    </div>
                    <div class="col-lg-2 col-md-4 mb-md-3 mb-lg-0">
                        <div class="banner-features wow fadeIn animated hover-up">
                            <img src="/assets/imgs/theme/icons/feature-2.png" alt="">
                            <h4 class="bg-3">Online Order</h4>
                        </div>
                    </div>
                    <div class="col-lg-2 col-md-4 mb-md-3 mb-lg-0">
                        <div class="banner-features wow fadeIn animated hover-up">
                            <img src="/assets/imgs/theme/icons/feature-3.png" alt="">
                            <h4 class="bg-2">Save Money</h4>
                        </div>
                    </div>
                    <div class="col-lg-2 col-md-4 mb-md-3 mb-lg-0">
                        <div class="banner-features wow fadeIn animated hover-up">
                            <img src="/assets/imgs/theme/icons/feature-4.png" alt="">
                            <h4 class="bg-4">Promotions</h4>
                        </div>
                    </div>
                    <div class="col-lg-2 col-md-4 mb-md-3 mb-lg-0">
                        <div class="banner-features wow fadeIn animated hover-up">
                            <img src="/assets/imgs/theme/icons/feature-5.png" alt="">
                            <h4 class="bg-5">Happy Sell</h4>
                        </div>
                    </div>
                    <div class="col-lg-2 col-md-4 mb-md-3 mb-lg-0">
                        <div class="banner-features wow fadeIn animated hover-up">
                            <img src="/assets/imgs/theme/icons/feature-6.png" alt="">
                            <h4 class="bg-6">24/7 Support</h4>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section class="product-tabs section-padding position-relative wow fadeIn animated">
            <div class="bg-square"></div>
            <div class="container">
                <div class="tab-header">
                    <ul class="nav nav-tabs" id="myTab" role="tablist">
                        <li class="nav-item" role="presentation">
                            <button class="nav-link active" id="nav-tab-one" data-bs-toggle="tab"
                                data-bs-target="#tab-one" type="button" role="tab" aria-controls="tab-one"
                                aria-selected="true">Featured</button>
                        </li>
                    </ul>
                    <a href="/user/shop" class="view-more d-none d-md-flex">View More<i
                            class="fi-rs-angle-double-small-right"></i></a>
                </div>
                <!--End nav-tabs-->
                <div class="tab-content wow fadeIn animated" id="myTabContent">
                    <div class="tab-pane fade show active" id="tab-one" role="tabpanel" aria-labelledby="tab-one">
                        <div class="row product-grid-4">
                            <% products.slice(0, 8).forEach(product=> { %>
                                <div class="col-lg-3 col-md-4 col-12 col-sm-6">
                                    <div class="product-cart-wrap mb-30">
                                        <div class="product-img-action-wrap">
                                            <div class="product-img product-img-zoom">
                                                <a href="/user/singleproduct/<%= product.id %>">
                                                    <img class="default-img"
                                                        src="/uploads/<%= product.productImages[0] %>" alt="">
                                                    <img class="hover-img"
                                                        src="/uploads/<%= product.productImages[0] %>" alt="">
                                                </a>
                                            </div>
                                            <div class="product-action-1">
                                                <a aria-label="Quick view" class="action-btn hover-up"
                                                    data-bs-toggle="modal" data-bs-target="#quickViewModal"><i
                                                        class="fi-rs-eye"></i></a>
                                                <a aria-label="Add To Wishlist"
                                                    class="action-btn hover-up add-to-wishlist" href="#"
                                                    data-product-id="<%= product.id %>">
                                                    <i class="fi-rs-heart"></i>
                                                </a>
                                                <a aria-label="Compare" class="action-btn hover-up"
                                                    href="shop-compare.html"><i class="fi-rs-shuffle"></i></a>
                                            </div>
                                            <div class="product-badges product-badges-position product-badges-mrg">
                                                <span class="hot">Hot</span>
                                            </div>
                                        </div>
                                        <div class="product-content-wrap">
                                            <div class="product-category">
                                                <a href="shop-grid-right.html">
                                                    <%= product.category %>
                                                </a>
                                            </div>
                                            <h2><a href="shop-product-right.html">
                                                    <%= product.productname %>
                                                </a></h2>
                                            <div class="rating-result" title="90%">
                                                <span>
                                                    <span>90%</span>
                                                </span>
                                            </div>
                                            <div class="product-price">
                                                <% if (product.mainprice < product.price && product.mainprice!==0) { %>
                                                    <span>$<%= product.mainprice %></span>
                                                    <span class="old-price">$<%= product.price %></span>
                                                    <% } else { %>
                                                        <span>$<%= product.price %></span>
                                                        <span class="old-price">$<%= product.mainprice %></span>
                                                        <% } %>
                                            </div>
                                            <div class="show">
                                                <a aria-label="Add To Cart" class="action-btn hover-up add-to-cart"
                                                    href="#" data-product-id="<%= product.id %>">
                                                    <i class="fi-rs-shopping-bag-add"></i></a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <% }) %>
                        </div>
                        <!--End product-grid-4-->
                    </div>
                </div>
                <!--En tab two (Popular)-->
                <div class="tab-pane fade" id="tab-three" role="tabpanel" aria-labelledby="tab-three">
                    <div class="row product-grid-4">
                    </div>
                    <!--End product-grid-4-->
                </div>
                <!--En tab three (New added)-->
            </div>
        </section>
    </main>
    <script>
        function navigateTo() {
            window.location.href = '/user/singleproduct'
        }
    </script>
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const addToWishlistButtons = document.querySelectorAll(".add-to-wishlist");
            const addToCartButtons = document.querySelectorAll(".add-to-cart");

            addToWishlistButtons.forEach(button => {
                button.addEventListener("click", function (e) {
                    e.preventDefault();
                    const productId = button.getAttribute("data-product-id");

                    fetch("/user/addtowishlist", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify({ productId: productId })
                    })
                        .then(response => {
                            if (!response.ok) {
                                throw new Error("Network response was not ok");
                            }
                            return response.json();
                        })
                        .then(data => {
                            if (data.alreadyInWishlist) {
                                Swal.fire({
                                    icon: 'info',
                                    title: 'Already in Wishlist!',
                                    text: 'This product is already in your wishlist.'
                                });
                            } else {
                                Swal.fire({
                                    icon: 'success',
                                    title: 'Added to Wishlist!',
                                    text: 'This product has been added to your wishlist.'
                                })
                            }
                        })
                        .catch(error => {
                            console.error('Error:', error);
                            Swal.fire({
                                icon: 'error',
                                title: 'Oops...',
                                text: 'Something went wrong! Please try again.'
                            });
                        });
                });
            });

            addToCartButtons.forEach(button => {
                button.addEventListener("click", function (e) {
                    e.preventDefault();
                    const productId = button.getAttribute("data-product-id");

                    fetch("/user/addtocart", {
                        method: "POST",
                        headers: {
                            "Content-Type": "application/json"
                        },
                        body: JSON.stringify({ productId: productId })
                    })
                        .then(response => {
                            if (!response.ok) {
                                throw new Error("Network response was not ok");
                            }
                            return response.json();
                        })
                        .then(data => {
                            if (data.alreadyInCart) {
                                Swal.fire({
                                    icon: 'info',
                                    title: 'Already in Cart!',
                                    text: 'This product is already in your Cart.'
                                });
                            } else {
                                Swal.fire({
                                    icon: 'success',
                                    title: 'Added to Cart!',
                                    text: 'This product has been added to your Cart.'
                                })
                            }
                        })
                        .catch(error => {
                            console.error('Error:', error);
                            Swal.fire({
                                icon: 'error',
                                title: 'Oops...',
                                text: 'Something went wrong! Please try again.'
                            });
                        });
                });
            });
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


    <%- include("../layouts/userFooter") %>